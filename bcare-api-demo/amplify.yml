version: 1
applications:
  - frontend:
      phases:
        preBuild:
          commands:
            - npm ci
        build:
          commands:
            - echo "NEXT_PUBLIC_API_KEY=${NEXT_PUBLIC_API_KEY}" >> .env
            - echo "NEXT_PUBLIC_API_BASE_URL=${NEXT_PUBLIC_API_BASE_URL}" >> .env
            - echo "NEXT_PUBLIC_DEFAULT_USERNAME=${NEXT_PUBLIC_DEFAULT_USERNAME}" >> .env
            - echo "NEXT_PUBLIC_DEFAULT_PASSWORD=${NEXT_PUBLIC_DEFAULT_PASSWORD}" >> .env
            - echo "NEXT_PUBLIC_DEFAULT_SUBSCRIPTION_ID=${NEXT_PUBLIC_DEFAULT_SUBSCRIPTION_ID}" >> .env
            - npm run build
      artifacts:
        baseDirectory: .next
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/*
appRoot: 'bcare-api-demo'
monorepo:
  mainApp: ./bcare-api-demo
